---
title: "Midterm Project"
author: " Team Extrapolates"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r init, include=FALSE}
library(ezids)
# knitr::opts_chunk$set(warning = F, results = "markup", message = F)
knitr::opts_chunk$set(echo = T, warning = F, results = "show", message = F)
options(scientific=T, digits = 3) 
```

# OKCupid Dataset Analysis - Code & Technical Analysis

## STEP 1: Loading the Dataset

```{r}
# Reading the dataset
cupid_df = read.csv("okcupid_profiles.csv")

# Structure of the dataset
str(cupid_df)
```


## STEP 2: Data Cleaning

## STEP 3: Exploratory Data Analysis


{r}
# Graphical Representations

# Histogram of age
ggplot(cleaned_cupid_df, aes(x = age, fill = age)) + geom_histogram(binwidth = 5, fill = "blue", color = "black") + labs(title = "Age Distribution", x = "Age", y = "Frequency") + theme_minimal()


{r}
# Density plot for height
ggplot(cleaned_cupid_df, aes(x=height, fill = height)) +  geom_bar(fill="green", color="black")+ labs(title = "Height Distribution", x = "Height", y = "Frequency") + theme_minimal()


After looking at the descriptive stats for variable ‘height’, it is evident there seems to be outlines which might effect our dataset. Let’s remove them.

{r}
cleaned_cupid_df <- outlierKD2(cleaned_cupid_df, height, rm = TRUE, boxplt = TRUE, histogram = FALSE, qqplt = TRUE)


### Distribution of characteristics and marial status variables
{r}
ggplot(cleaned_cupid_df, aes(x=sex, fill=sex))+geom_bar(color = "black")+ggtitle("Male and Female count in Dataset") + theme_minimal()+ xlab("Gender") +  ylab("Frequency")


{r}
# Bar plot for status
ggplot(cleaned_cupid_df, aes(x = status, fill = status)) + geom_bar(fill = "orange") + labs(title = "Status Distribution (Beside Single)", x = "Status", y = "Count") + theme_minimal() + geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3)

## STEP 4: SMART Questions



### 4.3: Does the drinking and smoking habit of an individual who drinks 'socially'and smokes definitively explain the body type of them?

First we filter people who drinks 'socially' and smokes as social_smokers_df 
```{r}
# filter dataset
social_smokers_df <- cleaned_cupid_df %>% filter(drinks == "socially" & smokes != "no")

# Bar plot
ggplot(social_smokers_df, aes(x = body_type, fill = body_type)) + geom_bar() + scale_fill_brewer(palette = "Set3") + 
labs(title = "Body Type Distribution Among Social Drinkers Who Smoke", x = "Body Type", y = "Number of Individuals") + theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3)

```
Most of the people who drink 'socially' and smoke are average, fit and even athletic. People with body types jacked, overweight and used up are lowest in number.  

```{r}
# Chi-square test
chi_square_result <- chisq.test(table(social_smokers_df$body_type))
print(chi_square_result)
```
We perform Chi-squared test because the variables we work on are categorized. We can see the p-value is less than 0.05. So we can reject the Null hypothesis and can conclude there is a association between drinking habit and their body type.

### 4.4 Is there a significant association between an individual’s diet preference (ranging from 'anything' to 'strictly vegetarian') and having a 'healthy' body type?
```{r}
# Filtering the data
diet_body_df <- cleaned_cupid_df %>%filter(diet %in% c("anything", "strictly anything", "mostly vegetarian", "strictly vegetarian")) %>%mutate(diet_category = ifelse(diet %in% c("anything", "strictly anything"), "Anything", "Vegetarian"),healthy_body_type = ifelse(body_type %in% c("athletic", "average", "fit", "jacked"), "Healthy", "Unhealthy"))

# bar plot 
ggplot(diet_body_df, aes(x = diet_category, fill = healthy_body_type)) +geom_bar(position = "dodge") +labs(title = "Diet Preference and 'Healthy' Body Type Distribution",x = "Diet Category",y = "Number of Individuals",fill = "Body Type (Healthy)") +scale_fill_brewer(palette = "Set3") +theme_minimal() +geom_text(stat = "count", aes(label = ..count..),position = position_dodge(width = 0.9), vjust = -0.5, size = 3) 

```
people who eat both vegetarian and non-vegetarian were more compared to people who stick with vegetarian food. But the difference in healthy and unhealthy body is less for vegetarians compared to people who eat anything.

```{r}
# Chi-square
diet_body_table <- table(diet_body_df$diet_category, diet_body_df$healthy_body_type)
chi_square_result <- chisq.test(diet_body_table)
print(chi_square_result)
```
We perform Chi-squared test because the variables we work on are categorized. We can see the p-value is equal to 0.05. So we can reject the Null hypothesis and can conclude there is a association between diet inntake and body type a person has.



